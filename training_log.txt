2025-12-02 15:37:22,297 - INFO - Using device: cuda
2025-12-02 15:37:22,297 - INFO - Setting random seed: 42
2025-12-02 15:37:22,399 - INFO - Selected ByT5-small byte-level model
2025-12-02 15:37:22,399 - INFO - ByT5 detected: increasing epochs to 8 (byte-level models need longer training)
2025-12-02 15:37:22,399 - INFO - Using model: google/byt5-small
2025-12-02 15:37:22,399 - INFO - Loading data from ./data/processed/paired_native_romaji_llmjp_binary.csv
2025-12-02 15:37:22,937 - INFO - Loaded 3711 samples from ./data/processed/paired_native_romaji_llmjp_binary.csv
2025-12-02 15:37:22,941 - INFO - Using 3711 samples after cleaning
2025-12-02 15:37:22,943 - INFO - Label distribution: {0: 2226, 1: 1485}
2025-12-02 15:37:22,947 - INFO - Train: 2968, Test: 743
2025-12-02 15:37:22,947 - INFO - Loading tokenizer: google/byt5-small
2025-12-02 15:37:23,122 - INFO - Train batches: 186, Test batches: 47
2025-12-02 15:37:23,126 - INFO - Class distribution: {0: 1780, 1: 1188}
2025-12-02 15:37:23,127 - INFO - Computed class weights: {0: 0.8337078651685393, 1: 1.2491582491582491}
2025-12-02 15:37:23,127 - INFO - Creating BERT model...
2025-12-02 15:37:23,127 - INFO - ByT5 model: using float32 to avoid NaN loss with weighted loss function
`torch_dtype` is deprecated! Use `dtype` instead!
Some weights of T5ForSequenceClassification were not initialized from the model checkpoint at google/byt5-small and are newly initialized: ['classification_head.dense.bias', 'classification_head.dense.weight', 'classification_head.out_proj.bias', 'classification_head.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-12-02 15:37:24,955 - INFO - T5/ByT5 model initialized with google/byt5-small
2025-12-02 15:37:25,287 - INFO - Using weighted loss with class weights: [0.83370787 1.2491583 ]
2025-12-02 15:37:25,287 - INFO - Starting training for 8 epochs...
2025-12-02 15:37:25,287 - INFO - 
Epoch 1/8
Using CuPy for GPU-accelerated array operations

Training:   0%|          | 0/186 [00:00<?, ?it/s]
Training:   1%|          | 1/186 [00:01<05:46,  1.87s/it]
Training:   1%|          | 2/186 [00:03<05:05,  1.66s/it]
Training:   2%|▏         | 3/186 [00:04<04:53,  1.61s/it]
Training:   2%|▏         | 4/186 [00:06<04:49,  1.59s/it]
Training:   3%|▎         | 5/186 [00:08<04:44,  1.57s/it]
Training:   3%|▎         | 6/186 [00:09<04:39,  1.55s/it]
Training:   4%|▍         | 7/186 [00:11<04:35,  1.54s/it]
Training:   4%|▍         | 8/186 [00:12<04:38,  1.56s/it]
Training:   5%|▍         | 9/186 [00:14<04:35,  1.55s/it]
Training:   5%|▌         | 10/186 [00:15<04:32,  1.55s/it]
Training:   6%|▌         | 11/186 [00:17<04:29,  1.54s/it]
Training:   6%|▋         | 12/186 [00:18<04:27,  1.54s/it]
Training:   7%|▋         | 13/186 [00:20<04:26,  1.54s/it]
Training:   8%|▊         | 14/186 [00:21<04:27,  1.55s/it]
Training:   8%|▊         | 15/186 [00:23<04:26,  1.56s/it]
Training:   9%|▊         | 16/186 [00:25<04:25,  1.56s/it]
Training:   9%|▉         | 17/186 [00:26<04:22,  1.55s/it]
Training:  10%|▉         | 18/186 [00:28<04:19,  1.54s/it]
Training:  10%|█         | 19/186 [00:29<04:17,  1.54s/it]
Training:  11%|█         | 20/186 [00:31<04:14,  1.54s/it]
Training:  11%|█▏        | 21/186 [00:32<04:12,  1.53s/it]
Training:  12%|█▏        | 22/186 [00:34<04:10,  1.53s/it]
Training:  12%|█▏        | 23/186 [00:35<04:09,  1.53s/it]
Training:  13%|█▎        | 24/186 [00:37<04:08,  1.54s/it]
Training:  13%|█▎        | 25/186 [00:38<04:07,  1.54s/it]
Training:  14%|█▍        | 26/186 [00:40<04:05,  1.54s/it]
Training:  15%|█▍        | 27/186 [00:41<04:04,  1.53s/it]
Training:  15%|█▌        | 28/186 [00:43<04:03,  1.54s/it]
Training:  16%|█▌        | 29/186 [00:44<04:00,  1.53s/it]
Training:  16%|█▌        | 30/186 [00:46<03:58,  1.53s/it]
Training:  17%|█▋        | 31/186 [00:48<03:58,  1.54s/it]
Training:  17%|█▋        | 32/186 [00:49<03:55,  1.53s/it]
Training:  18%|█▊        | 33/186 [00:51<03:53,  1.53s/it]
Training:  18%|█▊        | 34/186 [00:52<03:51,  1.52s/it]
Training:  19%|█▉        | 35/186 [00:54<03:50,  1.53s/it]
Training:  19%|█▉        | 36/186 [00:55<03:49,  1.53s/it]
Training:  20%|█▉        | 37/186 [00:57<03:48,  1.53s/it]
Training:  20%|██        | 38/186 [00:58<03:46,  1.53s/it]
Training:  21%|██        | 39/186 [01:00<03:45,  1.53s/it]
Training:  22%|██▏       | 40/186 [01:01<03:43,  1.53s/it]
Training:  22%|██▏       | 41/186 [01:03<03:42,  1.53s/it]
Training:  23%|██▎       | 42/186 [01:04<03:41,  1.54s/it]
Training:  23%|██▎       | 43/186 [01:06<03:38,  1.53s/it]
Training:  24%|██▎       | 44/186 [01:07<03:37,  1.53s/it]
Training:  24%|██▍       | 45/186 [01:09<03:36,  1.53s/it]
Training:  25%|██▍       | 46/186 [01:11<03:37,  1.56s/it]
Training:  25%|██▌       | 47/186 [01:12<03:35,  1.55s/it]
Training:  26%|██▌       | 48/186 [01:14<03:33,  1.55s/it]
Training:  26%|██▋       | 49/186 [01:15<03:30,  1.54s/it]
Training:  27%|██▋       | 50/186 [01:17<03:29,  1.54s/it]
Training:  27%|██▋       | 51/186 [01:18<03:26,  1.53s/it]
Training:  28%|██▊       | 52/186 [01:20<03:24,  1.53s/it]
Training:  28%|██▊       | 53/186 [01:21<03:23,  1.53s/it]
Training:  29%|██▉       | 54/186 [01:23<03:21,  1.53s/it]
Training:  30%|██▉       | 55/186 [01:24<03:21,  1.54s/it]
Training:  30%|███       | 56/186 [01:26<03:21,  1.55s/it]
Training:  31%|███       | 57/186 [01:28<03:21,  1.56s/it]
Training:  31%|███       | 58/186 [01:29<03:19,  1.56s/it]
Training:  32%|███▏      | 59/186 [01:31<03:17,  1.55s/it]
Training:  32%|███▏      | 60/186 [01:32<03:15,  1.55s/it]
Training:  33%|███▎      | 61/186 [01:34<03:12,  1.54s/it]
Training:  33%|███▎      | 62/186 [01:35<03:11,  1.54s/it]
Training:  34%|███▍      | 63/186 [01:37<03:09,  1.54s/it]
Training:  34%|███▍      | 64/186 [01:38<03:07,  1.54s/it]
Training:  35%|███▍      | 65/186 [01:40<03:05,  1.54s/it]
Training:  35%|███▌      | 66/186 [01:41<03:03,  1.53s/it]
Training:  36%|███▌      | 67/186 [01:43<03:02,  1.53s/it]
Training:  37%|███▋      | 68/186 [01:44<03:00,  1.53s/it]
Training:  37%|███▋      | 69/186 [01:46<02:59,  1.53s/it]
Training:  38%|███▊      | 70/186 [01:47<02:57,  1.53s/it]
Training:  38%|███▊      | 71/186 [01:49<02:56,  1.53s/it]
Training:  39%|███▊      | 72/186 [01:51<02:56,  1.55s/it]
Training:  39%|███▉      | 73/186 [01:52<02:54,  1.55s/it]
Training:  40%|███▉      | 74/186 [01:54<02:54,  1.56s/it]
Training:  40%|████      | 75/186 [01:55<02:52,  1.55s/it]
Training:  41%|████      | 76/186 [01:57<02:49,  1.54s/it]
Training:  41%|████▏     | 77/186 [01:58<02:46,  1.53s/it]
Training:  42%|████▏     | 78/186 [02:00<02:44,  1.52s/it]
Training:  42%|████▏     | 79/186 [02:01<02:43,  1.53s/it]
Training:  43%|████▎     | 80/186 [02:03<02:41,  1.52s/it]
Training:  44%|████▎     | 81/186 [02:04<02:39,  1.52s/it]
Training:  44%|████▍     | 82/186 [02:06<02:38,  1.52s/it]
Training:  45%|████▍     | 83/186 [02:07<02:37,  1.53s/it]
Training:  45%|████▌     | 84/186 [02:09<02:35,  1.53s/it]
Training:  46%|████▌     | 85/186 [02:10<02:34,  1.53s/it]
Training:  46%|████▌     | 86/186 [02:12<02:33,  1.53s/it]
Training:  47%|████▋     | 87/186 [02:14<02:31,  1.53s/it]
Training:  47%|████▋     | 88/186 [02:15<02:29,  1.53s/it]
Training:  48%|████▊     | 89/186 [02:17<02:28,  1.54s/it]
Training:  48%|████▊     | 90/186 [02:18<02:27,  1.53s/it]
Training:  49%|████▉     | 91/186 [02:20<02:25,  1.53s/it]
Training:  49%|████▉     | 92/186 [02:21<02:23,  1.52s/it]
Training:  50%|█████     | 93/186 [02:23<02:22,  1.53s/it]
Training:  51%|█████     | 94/186 [02:24<02:20,  1.53s/it]
Training:  51%|█████     | 95/186 [02:26<02:18,  1.53s/it]
Training:  52%|█████▏    | 96/186 [02:27<02:17,  1.53s/it]
Training:  52%|█████▏    | 97/186 [02:29<02:16,  1.53s/it]
Training:  53%|█████▎    | 98/186 [02:30<02:14,  1.53s/it]
Training:  53%|█████▎    | 99/186 [02:32<02:13,  1.53s/it]
Training:  54%|█████▍    | 100/186 [02:33<02:11,  1.53s/it]
Training:  54%|█████▍    | 101/186 [02:35<02:10,  1.53s/it]
Training:  55%|█████▍    | 102/186 [02:37<02:08,  1.53s/it]
Training:  55%|█████▌    | 103/186 [02:38<02:07,  1.54s/it]
Training:  56%|█████▌    | 104/186 [02:40<02:05,  1.53s/it]
Training:  56%|█████▋    | 105/186 [02:41<02:03,  1.53s/it]
Training:  57%|█████▋    | 106/186 [02:43<02:01,  1.52s/it]
Training:  58%|█████▊    | 107/186 [02:44<02:00,  1.53s/it]
Training:  58%|█████▊    | 108/186 [02:46<01:59,  1.53s/it]
Training:  59%|█████▊    | 109/186 [02:47<01:57,  1.53s/it]
Training:  59%|█████▉    | 110/186 [02:49<01:56,  1.53s/it]
Training:  60%|█████▉    | 111/186 [02:50<01:54,  1.53s/it]
Training:  60%|██████    | 112/186 [02:52<01:52,  1.52s/it]
Training:  61%|██████    | 113/186 [02:53<01:51,  1.52s/it]
Training:  61%|██████▏   | 114/186 [02:55<01:50,  1.53s/it]
Training:  62%|██████▏   | 115/186 [02:56<01:48,  1.53s/it]
Training:  62%|██████▏   | 116/186 [02:58<01:47,  1.53s/it]
Training:  63%|██████▎   | 117/186 [02:59<01:45,  1.53s/it]
Training:  63%|██████▎   | 118/186 [03:01<01:43,  1.53s/it]
Training:  64%|██████▍   | 119/186 [03:02<01:42,  1.53s/it]
Training:  65%|██████▍   | 120/186 [03:04<01:40,  1.53s/it]
Training:  65%|██████▌   | 121/186 [03:06<01:39,  1.53s/it]
Training:  66%|██████▌   | 122/186 [03:07<01:37,  1.53s/it]
Training:  66%|██████▌   | 123/186 [03:09<01:36,  1.53s/it]
Training:  67%|██████▋   | 124/186 [03:10<01:35,  1.54s/it]
Training:  67%|██████▋   | 125/186 [03:12<01:34,  1.54s/it]
Training:  68%|██████▊   | 126/186 [03:13<01:32,  1.54s/it]
Training:  68%|██████▊   | 127/186 [03:15<01:31,  1.54s/it]
Training:  69%|██████▉   | 128/186 [03:16<01:29,  1.54s/it]
Training:  69%|██████▉   | 129/186 [03:18<01:28,  1.55s/it]
Training:  70%|██████▉   | 130/186 [03:19<01:26,  1.54s/it]
Training:  70%|███████   | 131/186 [03:21<01:24,  1.53s/it]
Training:  71%|███████   | 132/186 [03:22<01:23,  1.54s/it]
Training:  72%|███████▏  | 133/186 [03:24<01:21,  1.53s/it]
Training:  72%|███████▏  | 134/186 [03:26<01:19,  1.53s/it]
Training:  73%|███████▎  | 135/186 [03:27<01:17,  1.52s/it]
Training:  73%|███████▎  | 136/186 [03:29<01:16,  1.54s/it]
Training:  74%|███████▎  | 137/186 [03:30<01:15,  1.53s/it]
Training:  74%|███████▍  | 138/186 [03:32<01:13,  1.53s/it]